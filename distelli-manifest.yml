team-modules/puppetlabs-motd:
  PreBuild:
    - source /opt/rh/rh-ruby25/enable
    - echo "--- LETS update BUNDLER ---"
    - bundle update --full-index # We require the fullindex option because bundle complains we have too many gems
  Build:
    - echo "--- PROVISIONING ---"
    - source /opt/rh/rh-ruby25/enable
    - bundle exec rake 'litmus:provision_from_list[release_checks]'
    - cat inventory.yaml
    - echo "--- AGENT INSTALLATION ---"
    - bundle exec rake litmus:install_agent
    - echo "--- MODULE INSTALLATION ---"
    - bundle exec rake litmus:install_module
    - echo "--- TESTS RUNNING ---"
    - bundle exec rake litmus:acceptance:parallel
  AfterBuildSuccess:
    - source /opt/rh/rh-ruby25/enable
    - bundle exec rake litmus:tear_down
  AfterBuildFailure:
    - source /opt/rh/rh-ruby25/enable
    - bundle exec rake litmus:tear_down
  CommitData:
    - RepoType: Git
    - RepoPath: .
